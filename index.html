<!DOCTYPE html>
<html lang="es" style="scroll-behavior: smooth;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guía Interactiva de Ahorro en Paraguay</title>

    <meta name="google-site-verification" content="qBR45iQnVdAz-G01792fk1Mdzh7Rg-BOvy30nMg-wQI" />

    <meta name="description" content="Guía interactiva para analizar, comparar y elegir las mejores opciones de ahorro en Paraguay. Encuentra tasas de interés de bancos y cooperativas.">
    <meta name="keywords" content="ahorro paraguay, invertir en paraguay, plazo fijo, cda, banco nacional de fomento, itaú, familiar, visión banco, cooperativa medalla milagrosa, cooperativa universitaria, tasas de interés paraguay, comparador ahorro">
    <meta name="author" content="AhorroPY">
    <meta property="og:title" content="Guía Interactiva de Ahorro en Paraguay">
    <meta property="og:description" content="Compara y elige la mejor opción de ahorro en Paraguay con nuestra guía interactiva.">
    <meta property="og:type" content="website">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary-color: #2E5A88;
            --primary-hover: #25486C;
            --secondary-color: #4A4A4A;
            --background-color: #FDFBF8;
            --card-background: #FFFFFF;
            --text-color: #4A4A4A;
            --text-strong-color: #1F2937;
            --border-color: #EAEAEA;
            --header-bg: rgba(255, 255, 255, 0.8);
            --success-color: #10B981;
            --toast-bg: #1F2937;
            --toast-text: #FFFFFF;
        }

        html.dark {
            --primary-color: #58A6FF;
            --primary-hover: #79B8FF;
            --secondary-color: #8D96A0;
            --background-color: #0D1117;
            --card-background: #161B22;
            --text-color: #C9D1D9;
            --text-strong-color: #FFFFFF;
            --border-color: #30363D;
            --header-bg: rgba(22, 27, 34, 0.8);
            --toast-bg: #F9FAFB;
            --toast-text: #1F2937;
        }

        body, .card, header, .modal-content {
            transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out, border-color 0.3s ease-in-out;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        h1, h2, h3, h4, h5, h6 {
            color: var(--text-strong-color);
        }

        .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }
        .nav-link { transition: color 0.3s, border-bottom-color 0.3s; position: relative; }
        .nav-link:hover { color: var(--primary-color); }
        .nav-link:focus { outline: 2px solid var(--primary-color); outline-offset: 2px; }
        .nav-link.active { color: var(--primary-color); border-bottom: 2px solid var(--primary-color); }
        .card { background-color: var(--card-background); border: 1px solid var(--border-color); border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05); transition: transform 0.3s, box-shadow 0.3s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -4px rgba(0, 0, 0, 0.07); }
        .btn { transition: background-color 0.3s, color 0.3s, transform 0.3s; }
        .btn:focus, button:focus { outline: 2px solid var(--primary-color); outline-offset: 2px; }
        .btn-profile { transition: background-color 0.3s, color 0.3s, transform 0.3s; }
        .btn-profile.active { background-color: var(--primary-color); color: white; transform: scale(1.05); }

        .comparison-table { border-collapse: collapse; width: 100%; }
        .comparison-table th { background-color: var(--card-background); padding: 0.75rem; text-align: left; font-weight: 600; color: var(--secondary-color); }
        .comparison-table tbody tr { cursor: pointer; transition: background-color 0.2s; border-bottom: 1px solid var(--border-color); }
        html.light .comparison-table tbody tr:hover { background-color: #F0F5F9; }
        html.dark .comparison-table tbody tr:hover { background-color: #1f242c; }
        .comparison-table td { padding: 0.75rem; vertical-align: middle; }
        .comparison-table .comparison-checkbox { width: 1rem; height: 1rem; cursor: pointer; }

        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 300px; max-height: 400px; }
        #back-to-top { transition: opacity 0.3s, visibility 0.3s; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); z-index: 100; justify-content: center; align-items: center; backdrop-filter: blur(4px); }
        .modal-content { background-color: var(--card-background); padding: 2rem; border-radius: 0.5rem; max-width: 90%; max-height: 90%; overflow-y: auto; width: 800px; }
        .modal-close { position: absolute; top: 1rem; right: 1rem; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-color); }

        .filter-container { display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1.5rem; align-items: flex-end; }
        .filter-group { display: flex; flex-direction: column; }
        .filter-label { font-weight: 500; margin-bottom: 0.25rem; font-size: 0.875rem; }
        .favorite-btn { background: none; border: none; cursor: pointer; font-size: 1.25rem; color: #ccc; transition: color 0.2s, transform 0.2s; }
        .favorite-btn:hover { transform: scale(1.2); }
        .favorite-btn.active { color: #F05252; }

        .calculator-input, select { background-color: var(--background-color); border: 1px solid var(--border-color); color: var(--text-color); width: 100%; }
        select option { background-color: var(--card-background); color: var(--text-color); }

        #inicio { position: relative; overflow: hidden; }
        #inicio::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('assets/gem.png'); background-size: cover; background-position: center; background-repeat: no-repeat; opacity: 0.08; z-index: -1; transition: opacity 0.3s ease-in-out; }

        .toast { position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%); background-color: var(--toast-bg); color: var(--toast-text); padding: 1rem 1.5rem; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); z-index: 200; transition: bottom 0.5s ease-in-out; }
        .toast.show { bottom: 20px; }

        #compare-selected-btn:disabled { background-color: var(--secondary-color); cursor: not-allowed; opacity: 0.7; }

        @media (max-width: 768px) {
            .comparison-table thead { display: none; }
            .comparison-table tr { display: block; margin-bottom: 1rem; border: 1px solid var(--border-color); border-radius: 0.5rem; }
            .comparison-table td { display: block; text-align: right; padding: 0.5rem 1rem; position: relative; padding-left: 50%; }
            .comparison-table td::before { content: attr(data-label); position: absolute; left: 1rem; width: calc(50% - 1rem); padding-right: 1rem; text-align: left; font-weight: 600; }
            .comparison-table td:first-child, .comparison-table td:nth-child(2) { padding-left: 1rem; text-align: left; } /* Adjust checkbox and favorite cell */
            .filter-container { flex-direction: column; align-items: stretch; }
            .modal-content { width: 95%; padding: 1rem; }
        }
        @media (min-width: 768px) { .chart-container { height: 350px; } }
    </style>
</head>
<body class="antialiased">

    <header class="sticky top-0 z-50 shadow-sm bg-opacity-80 backdrop-blur-md" style="background-color: var(--header-bg);">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold">
                <a href="#inicio" aria-label="Ir al inicio"><span style="color: var(--primary-color);">Ahorro</span>PY</a>
            </div>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#contexto" class="nav-link font-medium pb-1">Contexto</a>
                <a href="#comparador" class="nav-link font-medium pb-1">Comparador</a>
                <a href="#perfiles" class="nav-link font-medium pb-1">Perfiles</a>
                <a href="#simulador" class="nav-link font-medium pb-1">Simulador</a>
                <a href="#glosario" class="nav-link font-medium pb-1">Glosario</a>
                <a href="#contacto" class="nav-link font-medium pb-1">Contacto</a>
                <button id="theme-toggle" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2" style="color: var(--text-color); --tw-ring-offset-color: var(--background-color); --tw-ring-color: var(--primary-color);">
                    <svg id="theme-icon-light" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    <svg id="theme-icon-dark" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                </button>
            </div>
             <div class="md:hidden flex items-center space-x-4">
                <button id="theme-toggle-mobile" class="p-2 rounded-full" style="color: var(--text-color);"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><use href="#theme-icon-light"/></svg></button>
                <button id="mobile-menu-button" class="p-2 rounded-md"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg></button>
            </div>
        </nav>
        
        <div id="mobile-menu" class="hidden md:hidden border-t" style="background-color: var(--card-background); border-color: var(--border-color);">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#contexto" class="block px-3 py-2 rounded-md text-base font-medium">Contexto</a>
                <a href="#comparador" class="block px-3 py-2 rounded-md text-base font-medium">Comparador</a>
                <a href="#perfiles" class="block px-3 py-2 rounded-md text-base font-medium">Perfiles</a>
                <a href="#simulador" class="block px-3 py-2 rounded-md text-base font-medium">Simulador</a>
                <a href="#glosario" class="block px-3 py-2 rounded-md text-base font-medium">Glosario</a>
                <a href="#contacto" class="block px-3 py-2 rounded-md text-base font-medium">Contacto</a>
            </div>
        </div>
    </header>

    <main>
        <section id="inicio" class="py-20" style="background-color: var(--card-background);">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-bold leading-tight">Tu Guía Interactiva de Ahorro en Paraguay</h1>
                <p class="mt-4 text-lg md:text-xl max-w-3xl mx-auto">Analiza, compara y elige la mejor opción para maximizar tus rendimientos. Tomar decisiones financieras informadas nunca fue tan fácil.</p>
                <div class="mt-8 flex justify-center gap-4">
                    <a href="#comparador" class="font-bold py-3 px-6 rounded-lg text-white" style="background-color: var(--primary-color); --hover-bg: var(--primary-hover);" onmouseover="this.style.backgroundColor=getComputedStyle(this).getPropertyValue('--hover-bg')" onmouseout="this.style.backgroundColor=getComputedStyle(this).getPropertyValue('--primary-color')">
                        Comparar opciones
                    </a>
                    <a href="#simulador" class="font-bold py-3 px-6 rounded-lg border" style="color: var(--primary-color); border-color: var(--primary-color);">
                        Simular rendimientos
                    </a>
                </div>
            </div>
        </section>

        <section id="contexto" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold">Entendiendo el Mercado Paraguayo</h2>
                    <p class="mt-2">Conoce los instrumentos de ahorro y los factores que influyen en tus ganancias.</p>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-2" style="color: var(--primary-color);">Cuentas de Ahorro</h3>
                        <p>Son la opción más básica y líquida. Ofrecen disponibilidad inmediata de tu dinero, pero sus tasas de interés suelen ser las más bajas. Ideales para fondos de emergencia o ahorros a muy corto plazo.</p>
                    </div>
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-2" style="color: var(--primary-color);">Ahorro a Plazo Fijo (CDA)</h3>
                        <p>Consiste en depositar una suma de dinero por un plazo determinado (3, 6, 12, 24+ meses) a una tasa de interés fija. A mayor plazo, mayor suele ser la tasa. Ofrece rendimientos superiores a las cuentas de ahorro.</p>
                    </div>
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-2" style="color: var(--primary-color);">Ahorro Programado</h3>
                        <p>Fomenta el hábito de ahorrar mediante depósitos mensuales de un monto fijo por un plazo determinado. Al final del plazo, recibes el capital más los intereses generados. Ideal para metas específicas.</p>
                    </div>
                </div>
                <div class="card p-6 md:p-8">
                    <h3 class="text-2xl font-bold text-center mb-2">Factor Clave: Tasa de Política Monetaria (TPM)</h3>
                    <p class="text-center max-w-3xl mx-auto mb-6">La TPM es la tasa de interés de referencia fijada por el Banco Central del Paraguay (BCP). Influye directamente en las tasas que los bancos ofrecen por los ahorros. Una TPM alta generalmente se traduce en mejores tasas para los ahorristas.</p>
                    <div class="text-center mb-6">
                        <span class="text-lg font-medium">Tasa Actual (Referencial):</span>
                        <span class="text-3xl font-bold ml-2" style="color: var(--primary-color);">6.00%</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="tpmChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="comparador" class="py-20" style="background-color: var(--card-background);">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold">Comparador de Productos de Ahorro</h2>
                    <p class="mt-2">Selecciona y compara hasta 3 productos. Las tasas son estimadas y pueden variar.</p>
                    <p class="text-sm mt-2">Última actualización de datos: <span id="last-updated" class="font-semibold">Cargando...</span></p>
                </div>
                
                <div class="filter-container mb-6">
                    <div class="filter-group">
                        <label for="filter-institution" class="filter-label">Institución</label>
                        <select id="filter-institution" class="p-2 rounded calculator-input">
                            <option value="all">Todas las instituciones</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filter-product" class="filter-label">Producto</label>
                        <select id="filter-product" class="p-2 rounded calculator-input">
                            <option value="all">Todos los productos</option>
                            <option value="cda">CDA / Plazo Fijo</option>
                            <option value="ahorro">Ahorro Programado</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filter-min-rate" class="filter-label">Tasa mínima</label>
                        <input type="number" id="filter-min-rate" min="0" max="20" step="0.1" placeholder="0%" class="p-2 rounded calculator-input">
                    </div>
                    
                    <div class="filter-group">
                        <label for="sort-by" class="filter-label">Ordenar por</label>
                        <select id="sort-by" class="p-2 rounded calculator-input">
                            <option value="tasa-desc">Mayor tasa primero</option>
                            <option value="tasa-asc">Menor tasa primero</option>
                            <option value="name">Nombre A-Z</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <button id="reset-filters" class="px-4 py-2 rounded" style="background-color: var(--border-color); color: var(--text-strong-color);">Limpiar filtros</button>
                    </div>

                    <div class="filter-group">
                       <button id="compare-selected-btn" class="font-bold py-2 px-4 rounded-lg text-white" style="background-color: var(--primary-color);" disabled>Comparar (0)</button>
                    </div>
                </div>
                
                <div class="w-full overflow-x-auto">
                    <table class="min-w-full comparison-table">
                        <thead>
                            <tr>
                                <th class="py-3 px-2 font-semibold text-center">Sel.</th>
                                <th class="text-left py-3 px-4 font-semibold">Favorito</th>
                                <th class="text-left py-3 px-4 font-semibold">Institución</th>
                                <th class="text-left py-3 px-4 font-semibold">Producto</th>
                                <th class="text-center py-3 px-4 font-semibold">Tasa Anual (%)</th>
                                <th class="text-right py-3 px-4 font-semibold hidden md:table-cell">Monto Mínimo (Gs.)</th>
                                <th class="text-left py-3 px-4 font-semibold hidden lg:table-cell">Plazo Mínimo</th>
                            </tr>
                        </thead>
                        <tbody id="comparison-body">
                            </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="perfiles" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold">Recomendación Según tu Perfil</h2>
                    <p class="mt-2">Encuentra la estrategia que mejor se adapta a tus metas y tolerancia al riesgo.</p>
                </div>
                <div class="flex justify-center space-x-2 md:space-x-4 mb-8">
                    <button id="btn-conservador" class="btn-profile active font-semibold py-2 px-4 rounded-full">Conservador</button>
                    <button id="btn-moderado" class="btn-profile font-semibold py-2 px-4 rounded-full">Moderado</button>
                    <button id="btn-maximizador" class="btn-profile font-semibold py-2 px-4 rounded-full">Maximizador</button>
                </div>
                
                <div id="content-conservador" class="profile-content card p-8">
                    <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-color);">Perfil Conservador: Seguridad y Liquidez</h3>
                    <p class="mb-4">Tu prioridad es proteger tu capital y tener acceso a él en cualquier momento. No te importa sacrificar un poco de rendimiento a cambio de máxima seguridad y disponibilidad.</p>
                    <div class="p-4 rounded-r-lg border-l-4" style="background-color: var(--background-color); border-color: var(--primary-color);">
                        <p class="font-bold">Mejor Opción:</p>
                        <p>Una <span class="font-semibold">Cuenta de Ahorros tradicional o Ahorro Programado</span> en un banco de primera línea y con respaldo estatal como el <span class="font-semibold">Banco Nacional de Fomento (BNF)</span>. Ofrece la máxima seguridad del sistema y te permite retirar tus fondos cuando los necesites sin penalización.</p>
                    </div>
                </div>
                <div id="content-moderado" class="profile-content card p-8 hidden">
                     <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-color);">Perfil Moderado: Equilibrio Inteligente</h3>
                    <p class="mb-4">Buscas un rendimiento justo por tu dinero, pero sin renunciar a una seguridad alta. Estás dispuesto a inmovilizar una parte de tus ahorros por un tiempo corto o mediano para obtener una mejor tasa.</p>
                    <div class="p-4 rounded-r-lg border-l-4" style="background-color: var(--background-color); border-color: var(--primary-color);">
                        <p class="font-bold">Mejor Opción:</p>
                        <p>Un <span class="font-semibold">Certificado de Depósito de Ahorro (CDA) a mediano plazo (12 a 24 meses)</span> en bancos privados sólidos como <span class="font-semibold">Itaú, Continental o Familiar</span>. También, un CDA en una Cooperativa de Ahorro y Crédito grande como <span class="font-semibold">Medalla Milagrosa</span> puede ofrecer tasas muy competitivas con un buen nivel de seguridad.</p>
                    </div>
                </div>
                <div id="content-maximizador" class="profile-content card p-8 hidden">
                     <h3 class="text-2xl font-bold mb-4" style="color: var(--primary-color);">Perfil Maximizador: A por el Mayor Rendimiento</h3>
                    <p class="mb-4">Tu objetivo principal es obtener la tasa de interés más alta posible. Comprendes que para ello necesitas inmovilizar tu dinero por plazos más largos y estás cómodo con ello.</p>
                     <div class="p-4 rounded-r-lg border-l-4" style="background-color: var(--background-color); border-color: var(--primary-color);">
                        <p class="font-bold">Mejor Opción:</p>
                        <p>Un <span class="font-semibold">CDA a largo plazo (más de 24 meses)</span>. Investiga las ofertas de bancos como <span class="font-semibold">Banco GNB o Banco Familiar</span>, que a menudo tienen tasas promocionales atractivas para plazos extendidos. Las Cooperativas como <span class="font-semibold">Medalla Milagrosa o Universitaria</span> también son una excelente alternativa en este segmento, usualmente liderando las tasas de mercado para socios.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="simulador" class="py-20" style="background-color: var(--card-background);">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold">Simulador de Rendimientos</h2>
                    <p class="mt-2">Calcula tu ganancia nominal y real, considerando la inflación.</p>
                </div>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-4" style="color: var(--primary-color);">Parámetros de Simulación</h3>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="mb-4">
                                <label for="sim-amount" class="block mb-2 text-sm font-medium">Monto (Gs.)</label>
                                <input type="text" id="sim-amount" value="5.000.000" class="calculator-input rounded p-2 w-full">
                            </div>
                            <div class="mb-4">
                                <label for="sim-period" class="block mb-2 text-sm font-medium">Plazo (meses)</label>
                                <input type="number" id="sim-period" min="1" max="60" value="12" class="calculator-input rounded p-2 w-full">
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="sim-product" class="block mb-2 text-sm font-medium">Producto</label>
                            <select id="sim-product" class="calculator-input rounded p-2 w-full"></select>
                        </div>

                        <div class="mb-4">
                            <label for="sim-inflation" class="block mb-2 text-sm font-medium">Inflación Anual Estimada (%)</label>
                            <input type="number" id="sim-inflation" min="0" max="50" step="0.1" value="5.0" class="calculator-input rounded p-2 w-full">
                        </div>
                        
                        <div class="mt-6 flex gap-4">
                             <button id="calculate-btn" class="w-full text-white font-bold py-2 px-4 rounded" style="background-color: var(--primary-color);">Calcular</button>
                             <button id="share-btn" class="w-full font-bold py-2 px-4 rounded border" style="color: var(--primary-color); border-color: var(--primary-color);">Compartir</button>
                        </div>
                    </div>
                    
                    <div class="card p-6 flex flex-col">
                        <h3 class="text-xl font-bold mb-4" style="color: var(--primary-color);">Resultados de la Simulación</h3>
                        <div class="grid md:grid-cols-2 gap-4 mb-4 flex-grow">
                            <div class="flex flex-col justify-between">
                               <div class="mb-4 p-4 rounded-lg" style="background-color: var(--background-color);">
                                   <div class="flex justify-between items-center mb-2"><span id="initial-label">Inversión inicial:</span><span id="result-initial" class="font-bold"></span></div>
                                   <div class="flex justify-between items-center mb-2"><span>Intereses generados:</span><span id="result-interest" class="font-bold"></span></div>
                                   <div class="flex justify-between items-center text-lg"><span class="font-bold">Monto final:</span><span id="result-total" class="font-bold"></span></div>
                               </div>
                               <div class="p-4 rounded-lg bg-green-100 dark:bg-green-900/50 border border-green-200 dark:border-green-700">
                                   <div class="flex justify-between items-center text-green-800 dark:text-green-200">
                                       <span class="font-medium">Ganancia Real (vs Inflación):</span>
                                       <span id="result-real-interest" class="font-bold"></span>
                                   </div>
                               </div>
                            </div>
                            <div class="chart-container self-center" style="height: 180px; max-width: 180px;">
                                <canvas id="simulation-chart"></canvas>
                            </div>
                        </div>
                         <div class="mt-auto text-center text-sm">
                            <p>💡 Simulación con fines ilustrativos. El cálculo para Ahorro Programado es una aproximación simple.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="glosario" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold">Glosario Financiero</h2>
                    <p class="mt-2">Entiende los términos clave del mundo del ahorro.</p>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-2">CDA (Certificado de Depósito de Ahorro)</h3>
                        <p>Es un producto donde depositas tu dinero en una entidad financiera por un plazo fijo (ej. 1 año) a cambio de una tasa de interés que no cambia. No puedes retirar el dinero antes del vencimiento sin penalización.</p>
                    </div>
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-2">TPM (Tasa de Política Monetaria)</h3>
                        <p>Es la tasa de interés de referencia que fija el Banco Central del Paraguay (BCP). Funciona como una "tasa madre" que influye en todas las demás tasas del sistema, incluyendo las que te pagan por tus ahorros y las que pagas por préstamos.</p>
                    </div>
                    <div class="card p-6">
                         <h3 class="text-xl font-bold mb-2">INCOOP</h3>
                         <p>El Instituto Nacional de Cooperativismo. Es la entidad del estado que regula y supervisa a todas las cooperativas de Paraguay, asegurando su correcto funcionamiento y protegiendo a los socios.</p>
                    </div>
                    <div class="card p-6">
                        <h3 class="text-xl font-bold mb-2">IRP / IRE</h3>
                        <p>Impuesto a la Renta Personal (IRP) e Impuesto a la Renta Empresarial (IRE). Son los impuestos que se aplican sobre las ganancias. Los intereses que ganas por tus ahorros en bancos generalmente están sujetos a una retención de estos impuestos.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="fuentes" class="py-20">
            <div class="container mx-auto px-6 text-center">
                 <h2 class="text-2xl font-bold">Aviso Importante y Fuentes de Información</h2>
                 <p class="mt-4 max-w-3xl mx-auto">Las tasas de interés y condiciones de los productos financieros cambian constantemente. La información presentada en esta guía es referencial y fue recopilada con fines ilustrativos.</p>
                 <p class="mt-4 max-w-3xl mx-auto font-semibold">Antes de tomar cualquier decisión, es fundamental que verifiques las tasas vigentes y los términos y condiciones directamente en el sitio web oficial de cada institución o contactando a un ejecutivo de cuentas.</p>
                 <a href="https://www.bcp.gov.py/tasas-de-interes-indicativas" target="_blank" rel="noopener noreferrer" class="mt-6 inline-block text-white font-bold py-3 px-6 rounded-lg" style="background-color: var(--primary-color);">
                    Consultar Tasas Promedio en el BCP
                </a>
            </div>
        </section>

        <section id="contacto" class="py-20" style="background-color: var(--card-background);">
            <div class="container mx-auto px-6 text-center">
                 <h2 class="text-2xl font-bold">Sugerencias y Contacto</h2>
                 <p class="mt-4 max-w-3xl mx-auto">Esta es una herramienta independiente creada para facilitar la toma de decisiones financieras en Paraguay. Si encuentras algún error, tienes alguna sugerencia para mejorar la web o quieres añadir alguna institución, no dudes en escribirme.</p>
                 <p class="mt-6">
                    <a href="mailto:guidufox@proton.me" class="font-bold text-lg hover:underline" style="color: var(--primary-color);">
                        guidufox@proton.me
                    </a>
                </p>
            </div>
        </section>
    </main>
    
    <div id="details-modal" class="modal">
        <div class="modal-content relative">
            <button id="modal-close" class="modal-close" aria-label="Cerrar modal">&times;</button>
            <div id="modal-body"></div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <a href="#inicio" id="back-to-top" class="fixed bottom-5 right-5 text-white p-3 rounded-full shadow-lg transition-opacity duration-300 opacity-0 invisible" style="background-color: var(--primary-color);">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" /></svg>
    </a>

    <footer class="py-6 border-t" style="background-color: var(--card-background); border-color: var(--border-color);">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 AhorroPY. Herramienta de análisis financiero para el mercado paraguayo.</p>
            <p class="text-sm mt-2" style="color: var(--secondary-color);">Este sitio es una herramienta con fines puramente informativos.</p>
            <p class="text-sm mt-2">Desarrollado por <a href="https://github.com/Guidufox" target="_blank" rel="noopener noreferrer" class="hover:underline" style="color: var(--primary-color);">Guidufox</a>.</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DATABASE (antes en datos.json) ---
        const databaseData = {
          "lastUpdated": "2025-09-07",
          "products": [
            { "id": "medalla-cda", "institucion": "Cooperativa Medalla Milagrosa", "url": "https://www.medalla.coop.py/", "producto": "Ahorro a Plazo Fijo", "tipo": "cda", "tasa": 11.00, "montoMinimo": "1.000.000", "plazoMinimo": "12 meses", "ventaja": "Suele ofrecer las tasas más altas del mercado", "desventaja": "Requiere ser socio de la cooperativa", "proceso": "Primero debes asociarte (implica un aporte de capital). La apertura del plazo fijo es presencial.", "capitalizacion": "Al vencimiento.", "riesgo": "Regulada por INCOOP. Considerada de bajo riesgo en el sector cooperativo.", "fiscal": "Rendimientos (excedentes) suelen tener beneficios fiscales." },
            { "id": "universitaria-cda", "institucion": "Cooperativa Universitaria", "url": "https://www.universitaria.coop.py/", "producto": "CDA Socios", "tipo": "cda", "tasa": 10.50, "montoMinimo": "1.000.000", "plazoMinimo": "12 meses", "ventaja": "Excelentes tasas y gran solidez", "desventaja": "Requiere ser socio y cumplir requisitos", "proceso": "Debes ser socio para acceder. La apertura se realiza en sucursales.", "capitalizacion": "Generalmente al vencimiento.", "riesgo": "Regulada por INCOOP. Una de las cooperativas más grandes y seguras del país.", "fiscal": "Excedentes de socios suelen tener beneficios fiscales. Consultar normativa." },
            { "id": "gnb-cda", "institucion": "Banco GNB Paraguay", "url": "https://www.gnb.com.py/", "producto": "CDA a Plazo Fijo", "tipo": "cda", "tasa": 8.75, "montoMinimo": "10.000.000", "plazoMinimo": "12 meses", "ventaja": "Tasas muy competitivas", "desventaja": "Monto de apertura elevado", "proceso": "Gestión en sucursales con atención personalizada. Requiere documentación estándar.", "capitalizacion": "Al vencimiento.", "riesgo": "Parte de un grupo financiero internacional sólido. Entidad segura.", "fiscal": "Rendimientos sujetos a retención de IRP o IRE." },
            { "id": "familiar-cda", "institucion": "Banco Familiar", "url": "https://www.familiar.com.py/", "producto": "Ahorro a Plazo Fijo", "tipo": "cda", "tasa": 8.60, "montoMinimo": "1.000.000", "plazoMinimo": "12 meses", "ventaja": "Tasas atractivas y buena atención al cliente", "desventaja": "Red de sucursales más pequeña que los bancos más grandes", "proceso": "Apertura generalmente presencial. Se requiere documentación básica y comprobante de ingresos.", "capitalizacion": "Al vencimiento del plazo.", "riesgo": "Banco de larga trayectoria en el país, regulado y seguro.", "fiscal": "Rendimientos sujetos a retención de impuestos." },
            { "id": "atlas-cda", "institucion": "Banco Atlas", "url": "https://www.bancoatlas.com.py/", "producto": "CDA Plus", "tipo": "cda", "tasa": 8.50, "montoMinimo": "5.000.000", "plazoMinimo": "12 meses", "ventaja": "Buenas tasas y promociones frecuentes", "desventaja": "Mejores tasas a veces exigen plazos más largos", "proceso": "Contratación en sucursales con asesoría. Requiere CI y comprobantes de ingresos.", "capitalizacion": "Al vencimiento.", "riesgo": "Banco privado con décadas en el mercado, de alta solidez.", "fiscal": "Rendimientos alcanzados por el IRP o IRE. El banco realiza la retención." },
            { "id": "continental-cda", "institucion": "Banco Continental", "url": "https://www.bancontinental.com.py/", "producto": "CDA Digital a 1 año", "tipo": "cda", "tasa": 8.25, "montoMinimo": "1.000.000", "plazoMinimo": "12 meses", "ventaja": "Proceso 100% online y montos accesibles", "desventaja": "Tasas competitivas pero no siempre las más altas", "proceso": "Fácil y rápido a través de su app o web si ya eres cliente.", "capitalizacion": "Al vencimiento.", "riesgo": "Uno de los bancos privados más grandes y sólidos del país.", "fiscal": "Rendimientos gravados. El banco practica la retención correspondiente." },
            { "id": "itau-cda", "institucion": "Banco Itaú", "url": "https://www.itau.com.py/", "producto": "CDA Digital", "tipo": "cda", "tasa": 8.00, "montoMinimo": "1.000.000", "plazoMinimo": "12 meses", "ventaja": "Plataforma digital robusta y gran solidez del banco", "desventaja": "Sus tasas de interés no suelen ser las más altas del mercado", "proceso": "Fácil de gestionar desde la app o web para clientes. No requiere ir a sucursal.", "capitalizacion": "Al vencimiento.", "riesgo": "Uno de los bancos más grandes y seguros de la región.", "fiscal": "Rendimientos sujetos a la retención de impuestos vigente." },
            { "id": "bnf-cda", "institucion": "Banco Nacional de Fomento (BNF)", "url": "https://www.bnf.gov.py/", "producto": "CDA a 1 año", "tipo": "cda", "tasa": 7.50, "montoMinimo": "5.000.000", "plazoMinimo": "12 meses", "ventaja": "Máxima seguridad (banco estatal)", "desventaja": "Procesos pueden ser más burocráticos", "proceso": "Generalmente presencial en sucursales. Requiere documentación básica.", "capitalizacion": "Al vencimiento.", "riesgo": "Considerado el riesgo más bajo del sistema financiero paraguayo.", "fiscal": "Rendimientos sujetos a retención de IRP o IRE." },
            { "id": "familiar-ahorro", "institucion": "Banco Familiar", "url": "https://www.familiar.com.py/", "producto": "Ahorro Flexible", "tipo": "ahorro", "tasa": 7.25, "montoMinimo": "50.000 (cuota mensual)", "plazoMinimo": "6 meses", "ventaja": "Tasa muy competitiva para ahorro programado y plazos flexibles", "desventaja": "Puede requerir apertura presencial de cuenta base", "proceso": "Se puede programar desde la app o web una vez que se es cliente.", "capitalizacion": "Al final del plazo.", "riesgo": "Banco seguro y con buena reputación.", "fiscal": "Intereses sujetos a retención de impuestos." },
            { "id": "vision-ahorro", "institucion": "Visión Banco", "url": "https://www.visionbanco.com/", "producto": "Ahorro Programado Anual", "tipo": "ahorro", "tasa": 7.00, "montoMinimo": "100.000 (cuota mensual)", "plazoMinimo": "12 meses", "ventaja": "Fomenta el hábito del ahorro con cuotas bajas", "desventaja": "Tasa menor a un CDA por el mismo plazo", "proceso": "Contratación sencilla en sucursales o canales digitales para clientes.", "capitalizacion": "Los intereses se calculan sobre el saldo promedio y se acreditan al final.", "riesgo": "Banco de gran trayectoria y solidez. Opción segura.", "fiscal": "Intereses sujetos a retenciones de impuestos." },
            { "id": "atlas-ahorro", "institucion": "Banco Atlas", "url": "https://www.bancoatlas.com.py/", "producto": "Ahorro Programado Mi Meta", "tipo": "ahorro", "tasa": 6.50, "montoMinimo": "100.000 (cuota mensual)", "plazoMinimo": "12 meses", "ventaja": "Flexibilidad en plazos y cuotas, 100% digital", "desventaja": "Tasa inferior a otras opciones de inversión", "proceso": "Se puede abrir y gestionar desde la app del banco si ya eres cliente.", "capitalizacion": "Al final del periodo.", "riesgo": "Banco privado sólido y seguro.", "fiscal": "Rendimientos sujetos a retención de impuestos." },
            { "id": "itau-ahorro", "institucion": "Banco Itaú", "url": "https://www.itau.com.py/", "producto": "Mi Ahorro", "tipo": "ahorro", "tasa": 6.00, "montoMinimo": "50.000 (cuota mensual)", "plazoMinimo": "6 meses", "ventaja": "Muy fácil de configurar desde la app, fomenta el hábito", "desventaja": "Rendimiento modesto en comparación con otras opciones", "proceso": "Totalmente digital para clientes a través de la app de Itaú.", "capitalizacion": "Al final del plazo elegido.", "riesgo": "Muy bajo, respaldado por la solidez del banco.", "fiscal": "Intereses sujetos a retención de impuestos." },
            { "id": "bnf-ahorro", "institucion": "Banco Nacional de Fomento (BNF)", "url": "https://www.bnf.gov.py/", "producto": "Ahorro Programado", "tipo": "ahorro", "tasa": 5.50, "montoMinimo": "100.000 (cuota mensual)", "plazoMinimo": "12 meses", "ventaja": "Seguridad máxima del estado", "desventaja": "Tasa de interés más baja del mercado", "proceso": "Apertura presencial en sucursales.", "capitalizacion": "Al vencimiento.", "riesgo": "El más bajo posible al ser el banco del estado.", "fiscal": "Rendimientos sujetos a retención." }
          ]
        };

        // --- GLOBAL VARIABLES & STATE ---
        const allProducts = databaseData.products;
        let favorites = JSON.parse(localStorage.getItem('favorites')) || {};
        let selectedForComparison = new Set();
        let simulationChart;
        let tpmChartInstance;

        // --- DOM ELEMENT SELECTORS ---
        const themeToggle = document.getElementById('theme-toggle');
        const themeToggleMobile = document.getElementById('theme-toggle-mobile');
        const lightIcon = document.getElementById('theme-icon-light');
        const darkIcon = document.getElementById('theme-icon-dark');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const backToTopButton = document.getElementById('back-to-top');
        const toast = document.getElementById('toast');
        
        const lastUpdatedSpans = document.querySelectorAll('#last-updated');
        const tbody = document.getElementById('comparison-body');
        const modal = document.getElementById('details-modal');
        const modalBody = document.getElementById('modal-body');
        const modalClose = document.getElementById('modal-close');
        
        // Filter Elements
        const filterInstitutionSelect = document.getElementById('filter-institution');
        const filterProduct = document.getElementById('filter-product');
        const filterMinRate = document.getElementById('filter-min-rate');
        const sortBy = document.getElementById('sort-by');
        const resetFilters = document.getElementById('reset-filters');
        const compareBtn = document.getElementById('compare-selected-btn');
        
        // Simulator Elements
        const simAmount = document.getElementById('sim-amount');
        const simProductSelect = document.getElementById('sim-product');
        const simPeriod = document.getElementById('sim-period');
        const simInflation = document.getElementById('sim-inflation');
        const calculateBtn = document.getElementById('calculate-btn');
        const shareBtn = document.getElementById('share-btn');
        const resultInitial = document.getElementById('result-initial');
        const resultInterest = document.getElementById('result-interest');
        const resultRealInterest = document.getElementById('result-real-interest');
        const resultTotal = document.getElementById('result-total');
        const initialLabel = document.getElementById('initial-label');

        // --- INITIALIZATION ---
        function initializeApp() {
            // Populate dynamic elements
            lastUpdatedSpans.forEach(span => {
                span.textContent = new Date(databaseData.lastUpdated).toLocaleDateString('es-PY', { year: 'numeric', month: 'long', day: 'numeric' });
            });
            populateFilterInstitutions();
            populateSimulatorProducts();

            // Set up event listeners
            setupEventListeners();
            
            // Render initial views
            renderTable();
            loadSimulatorState();
            calculateReturns();
            initTheme();
            createTpmChart();
            loadFromURLParams();
        }

        // --- EVENT LISTENERS SETUP ---
        function setupEventListeners() {
            [themeToggle, themeToggleMobile].forEach(btn => btn.addEventListener('click', toggleTheme));
            mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
            window.onscroll = () => {
                const show = document.body.scrollTop > 300 || document.documentElement.scrollTop > 300;
                backToTopButton.classList.toggle('opacity-0', !show);
                backToTopButton.classList.toggle('invisible', !show);
            };

            [filterInstitutionSelect, filterProduct, sortBy].forEach(el => el.addEventListener('change', renderTable));
            filterMinRate.addEventListener('input', renderTable);
            resetFilters.addEventListener('click', () => {
                filterInstitutionSelect.value = 'all';
                filterProduct.value = 'all';
                filterMinRate.value = '';
                sortBy.value = 'tasa-desc';
                renderTable();
            });

            tbody.addEventListener('click', handleTableClick);
            compareBtn.addEventListener('click', showComparisonModal);
            modalClose.addEventListener('click', () => modal.style.display = 'none');
            window.addEventListener('click', (e) => { if (e.target === modal) modal.style.display = 'none'; });

            document.querySelectorAll('.btn-profile').forEach(button => {
                button.addEventListener('click', (e) => {
                    const profile = e.currentTarget.id.replace('btn-', '');
                    document.querySelectorAll('.btn-profile').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.profile-content').forEach(content => content.classList.add('hidden'));
                    e.currentTarget.classList.add('active');
                    document.getElementById(`content-${profile}`).classList.remove('hidden');
                });
            });

            simAmount.addEventListener('blur', (e) => { e.target.value = formatNumber(parseNumber(e.target.value)); });
            [calculateBtn, simProductSelect, simPeriod, simAmount, simInflation].forEach(el => {
                el.addEventListener('change', calculateReturns);
                el.addEventListener('input', calculateReturns);
            });
            shareBtn.addEventListener('click', handleShare);
        }

        // --- THEME LOGIC ---
        function applyTheme(isDark) {
            document.documentElement.classList.toggle('dark', isDark);
            document.documentElement.classList.toggle('light', !isDark);
            lightIcon.classList.toggle('hidden', isDark);
            darkIcon.classList.toggle('hidden', !isDark);
            const mobileIconHTML = isDark ? darkIcon.outerHTML : lightIcon.outerHTML;
            themeToggleMobile.innerHTML = mobileIconHTML;
            themeToggleMobile.querySelector('svg').classList.remove('hidden');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateChartColors();
        }

        function toggleTheme() {
            applyTheme(!document.documentElement.classList.contains('dark'));
        }

        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            applyTheme(savedTheme ? savedTheme === 'dark' : prefersDark);
        }

        // --- COMPARATOR & TABLE LOGIC ---
        function populateFilterInstitutions() {
            const institutions = [...new Set(allProducts.map(p => p.institucion))].sort();
            institutions.forEach(inst => {
                const option = document.createElement('option');
                option.value = inst;
                option.textContent = inst;
                filterInstitutionSelect.appendChild(option);
            });
        }

        function renderTable() {
            const institutionValue = filterInstitutionSelect.value;
            const productValue = filterProduct.value;
            const minRateValue = parseFloat(filterMinRate.value) || 0;
            const sortValue = sortBy.value;

            let filteredData = allProducts.filter(item => 
                (institutionValue === 'all' || item.institucion === institutionValue) &&
                (productValue === 'all' || item.tipo === productValue) &&
                item.tasa >= minRateValue
            );

            filteredData.sort((a, b) => {
                if (sortValue === 'tasa-desc') return b.tasa - a.tasa;
                if (sortValue === 'tasa-asc') return a.tasa - b.tasa;
                if (sortValue === 'name') return a.institucion.localeCompare(b.institucion);
                return 0;
            });

            tbody.innerHTML = '';
            filteredData.forEach(item => {
                const tr = document.createElement('tr');
                tr.dataset.id = item.id;
                const isFavorite = favorites[item.id] || false;
                tr.innerHTML = `
                    <td data-label="Seleccionar" class="text-center"><input type="checkbox" data-id="${item.id}" class="comparison-checkbox" ${selectedForComparison.has(item.id) ? 'checked' : ''}></td>
                    <td data-label="Favorito" class="text-center"><button class="favorite-btn ${isFavorite ? 'active' : ''}" data-id="${item.id}">${isFavorite ? '❤️' : '🤍'}</button></td>
                    <td data-label="Institución">${item.institucion}</td>
                    <td data-label="Producto">${item.producto}</td>
                    <td data-label="Tasa Anual (%)" class="text-center font-semibold text-green-700">${item.tasa.toFixed(2)}%</td>
                    <td data-label="Monto Mínimo (Gs.)" class="text-right hidden md:table-cell">${item.montoMinimo}</td>
                    <td data-label="Plazo Mínimo" class="hidden lg:table-cell">${item.plazoMinimo}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function handleTableClick(e) {
            const target = e.target;
            const row = target.closest('tr');
            if (!row) return;

            if (target.matches('.comparison-checkbox')) {
                const id = target.dataset.id;
                if (target.checked) {
                    if (selectedForComparison.size < 3) {
                        selectedForComparison.add(id);
                    } else {
                        target.checked = false;
                        showToast("Puedes seleccionar hasta 3 productos para comparar.");
                    }
                } else {
                    selectedForComparison.delete(id);
                }
                updateCompareButton();
                e.stopPropagation();
            } else if (target.matches('.favorite-btn')) {
                const id = target.dataset.id;
                favorites[id] = !favorites[id];
                localStorage.setItem('favorites', JSON.stringify(favorites));
                target.classList.toggle('active');
                target.innerHTML = favorites[id] ? '❤️' : '🤍';
                showToast(favorites[id] ? 'Añadido a favoritos' : 'Eliminado de favoritos');
                e.stopPropagation();
            } else {
                const itemData = allProducts.find(d => d.id === row.dataset.id);
                if (itemData) showDetailsModal(itemData);
            }
        }
        
        function updateCompareButton() {
            const count = selectedForComparison.size;
            compareBtn.textContent = `Comparar (${count})`;
            compareBtn.disabled = count < 2;
        }

        // --- MODAL LOGIC (Details & Comparison) ---
        function showDetailsModal(itemData) {
            modalBody.innerHTML = `<h3 class="text-2xl font-bold mb-4" style="color: var(--primary-color);">${itemData.institucion} - ${itemData.producto}</h3>
                <div class="grid md:grid-cols-2 gap-4 text-left">
                    <div class="p-3 rounded-lg" style="background-color: var(--background-color);"><strong>Tasa Anual:</strong> <span class="font-bold text-green-600">${itemData.tasa.toFixed(2)}%</span></div>
                    <div class="p-3 rounded-lg" style="background-color: var(--background-color);"><strong>Monto Mínimo:</strong> ${itemData.montoMinimo} Gs.</div>
                    <div class="p-3 rounded-lg" style="background-color: var(--background-color);"><strong>Plazo Mínimo:</strong> ${itemData.plazoMinimo}</div>
                    <div class="p-3 rounded-lg" style="background-color: var(--background-color);"><strong>Capitalización:</strong> ${itemData.capitalizacion}</div>
                </div>
                <div class="mt-4 p-4 rounded-lg" style="background-color: var(--background-color);"><p><strong class="text-green-600">Ventaja:</strong> ${itemData.ventaja}</p><p class="mt-2"><strong class="text-red-600">Desventaja:</strong> ${itemData.desventaja}</p></div>
                <div class="mt-4 p-4 rounded-lg" style="background-color: var(--background-color);"><p><strong>Proceso:</strong> ${itemData.proceso}</p></div>
                <div class="mt-4 p-4 rounded-lg" style="background-color: var(--background-color);"><p><strong>Riesgo:</strong> ${itemData.riesgo}</p></div>
                <div class="mt-6 text-center"><a href="${itemData.url}" target="_blank" rel="noopener noreferrer" class="text-white font-bold py-2 px-6 rounded" style="background-color: var(--primary-color);">Visitar Sitio Web</a></div>`;
            modal.style.display = 'flex';
        }

        function showComparisonModal() {
            const itemsToCompare = Array.from(selectedForComparison).map(id => allProducts.find(p => p.id === id));
            let tableHTML = `<h3 class="text-2xl font-bold mb-4 text-center" style="color: var(--primary-color);">Comparación de Productos</h3>
                <div class="overflow-x-auto"><table class="w-full text-left"><thead><tr><th class="p-2 border-b">Característica</th>`;
            itemsToCompare.forEach(item => {
                tableHTML += `<th class="p-2 border-b text-center font-semibold">${item.institucion}<br><span class="text-sm font-normal">${item.producto}</span></th>`;
            });
            tableHTML += `</tr></thead><tbody>`;
            const rows = [ 'tasa', 'montoMinimo', 'plazoMinimo', 'ventaja', 'desventaja', 'riesgo' ];
            const rowLabels = { tasa: 'Tasa Anual (%)', montoMinimo: 'Monto Mínimo (Gs)', plazoMinimo: 'Plazo Mínimo', ventaja: 'Ventaja Principal', desventaja: 'Desventaja Principal', riesgo: 'Nivel de Riesgo' };
            
            rows.forEach(key => {
                tableHTML += `<tr class="border-b"><td class="p-2 font-semibold">${rowLabels[key]}</td>`;
                itemsToCompare.forEach(item => {
                    const value = key === 'tasa' ? `<span class="font-bold text-green-600">${item[key].toFixed(2)}%</span>` : item[key];
                    tableHTML += `<td class="p-2 text-center">${value}</td>`;
                });
                tableHTML += `</tr>`;
            });

            tableHTML += `</tbody></table></div>`;
            modalBody.innerHTML = tableHTML;
            modal.style.display = 'flex';
        }
        
        // --- SIMULATOR LOGIC ---
        function populateSimulatorProducts() {
            // Sort by rate descending for better default selection
            const sortedProducts = [...allProducts].sort((a, b) => b.tasa - a.tasa);
            sortedProducts.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = `${item.institucion} - ${item.producto} (${item.tasa}%)`;
                simProductSelect.appendChild(option);
            });
        }

        function calculateReturns() {
            const amount = parseNumber(simAmount.value);
            const periodMonths = parseInt(simPeriod.value);
            const inflationRate = parseFloat(simInflation.value) || 0;
            const selectedProduct = allProducts.find(item => item.id === simProductSelect.value);

            if (!selectedProduct || !amount || !periodMonths) return;

            const rate = selectedProduct.tasa;
            let interest = 0;
            let initialAmount = amount;
            
            if (selectedProduct.tipo === 'cda') {
                initialLabel.textContent = "Inversión inicial:";
                interest = amount * (rate / 100) * (periodMonths / 12);
            } else if (selectedProduct.tipo === 'ahorro') {
                initialLabel.textContent = "Total Ahorrado (cuotas):";
                initialAmount = amount * periodMonths;
                interest = (initialAmount / 2) * (rate / 100) * (periodMonths / 12); // Approximation
            }

            const finalAmount = initialAmount + interest;
            const inflationLoss = initialAmount * (inflationRate / 100) * (periodMonths / 12);
            const realInterest = interest - inflationLoss;

            resultInitial.textContent = `${formatNumber(initialAmount)} Gs.`;
            resultInterest.textContent = `${formatNumber(interest)} Gs.`;
            resultTotal.textContent = `${formatNumber(finalAmount)} Gs.`;
            resultRealInterest.textContent = `${formatNumber(realInterest)} Gs.`;
            resultRealInterest.style.color = realInterest >= 0 ? 'var(--success-color)' : '#EF4444';
            
            updateSimulationChart(initialAmount, interest);
            saveSimulatorState();
        }

        function updateSimulationChart(capital, interest) {
            const ctx = document.getElementById('simulation-chart').getContext('2d');
            const chartData = {
                labels: ['Capital Inicial', 'Intereses Ganados'],
                datasets: [{
                    data: [capital, interest],
                    backgroundColor: ['#3B82F6', '#10B981'],
                    borderColor: getComputedStyle(document.documentElement).getPropertyValue('--card-background').trim(),
                    borderWidth: 2,
                }]
            };

            if (simulationChart) {
                simulationChart.data = chartData;
                simulationChart.update();
            } else {
                simulationChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-color').trim() } },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${formatNumber(context.raw)} Gs.`;
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }
        
        // --- CHART LOGIC (TPM & General) ---
        function createTpmChart() {
            const chartCtx = document.getElementById('tpmChart').getContext('2d');
            tpmChartInstance = new Chart(chartCtx, { type: 'line', data: { labels: ['Ene', 'Mar', 'May', 'Jul', 'Sep', 'Nov', 'Actual'], datasets: [{ label: 'Evolución Tasa de Política Monetaria (%)', data: [8.50, 8.50, 8.25, 7.75, 7.25, 6.75, 6.00], borderWidth: 2, fill: true, tension: 0.3 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false }, x: {} }, plugins: { legend: { display: false } } } });
        }
        
        function updateChartColors() {
            const textColor = getComputedStyle(document.documentElement).getPropertyValue('--text-color').trim();
            const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim();

            if (tpmChartInstance) {
                tpmChartInstance.data.datasets[0].borderColor = primaryColor;
                tpmChartInstance.options.scales.y.ticks.color = textColor;
                tpmChartInstance.options.scales.x.ticks.color = textColor;
                tpmChartInstance.update();
            }
            if (simulationChart) {
                simulationChart.options.plugins.legend.labels.color = textColor;
                simulationChart.update();
            }
        }

        // --- LOCAL STORAGE & URL PARAMS ---
        function saveSimulatorState() {
            const state = {
                amount: simAmount.value,
                period: simPeriod.value,
                product: simProductSelect.value,
                inflation: simInflation.value
            };
            localStorage.setItem('simulatorState', JSON.stringify(state));
        }

        function loadSimulatorState() {
            const state = JSON.parse(localStorage.getItem('simulatorState'));
            if (state) {
                simAmount.value = state.amount;
                simPeriod.value = state.period;
                simProductSelect.value = state.product;
                simInflation.value = state.inflation;
            }
        }

        function loadFromURLParams() {
            const params = new URLSearchParams(window.location.search);
            if (params.has('amount')) {
                simAmount.value = formatNumber(params.get('amount'));
                simPeriod.value = params.get('period') || '12';
                simProductSelect.value = params.get('product') || simProductSelect.options[0].value;
                simInflation.value = params.get('inflation') || '5.0';
                calculateReturns();
                showToast('Simulación cargada desde el enlace.');
                document.getElementById('simulador').scrollIntoView();
            }
        }
        
        // --- UTILITIES ---
        function showToast(message) {
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        function handleShare() {
            const state = {
                amount: parseNumber(simAmount.value),
                period: simPeriod.value,
                product: simProductSelect.value,
                inflation: simInflation.value
            };
            const params = new URLSearchParams(state).toString();
            const url = `${window.location.origin}${window.location.pathname}?${params}`;
            
            navigator.clipboard.writeText(url).then(() => {
                showToast('¡Enlace de simulación copiado!');
            }, () => {
                showToast('Error al copiar el enlace.');
            });
        }

        const formatNumber = num => new Intl.NumberFormat('es-PY').format(Math.round(num));
        const parseNumber = str => parseFloat(String(str).replace(/\./g, '')) || 0;

        // --- START THE APP ---
        initializeApp();
    });
    </script>
</body>
</html>
